function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},n={},s=t.parcelRequire8e51;null==s&&((s=function(e){if(e in r)return r[e].exports;if(e in n){var t=n[e];delete n[e];var s={id:e,exports:{}};return r[e]=s,t.call(s.exports,s,s.exports),s.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){n[e]=t},t.parcelRequire8e51=s),s.register("27Lyk",(function(t,r){var n,s;e(t.exports,"register",(()=>n),(e=>n=e)),e(t.exports,"resolve",(()=>s),(e=>s=e));var i={};n=function(e){for(var t=Object.keys(e),r=0;r<t.length;r++)i[t[r]]=e[t[r]]},s=function(e){var t=i[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),s.register("86Wyx",(function(e,t){!function(r,n){var s="function",i="undefined",a="object",o="string",l="model",c="name",u="type",d="vendor",f="version",h="architecture",b="console",p="mobile",w="tablet",g="smarttv",m="wearable",_="embedded",y="Amazon",v="Apple",x="ASUS",k="BlackBerry",j="Firefox",A="Google",S="Huawei",T="LG",E="Microsoft",I="Motorola",O="Opera",U="Samsung",R="Sony",V="Xiaomi",P="Zebra",B="Facebook",C=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},F=function(e,t){return typeof e===o&&-1!==J(t).indexOf(J(e))},J=function(e){return e.toLowerCase()},D=function(e,t){if(typeof e===o)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===i?e:e.substring(0,255)},N=function(e,t){for(var r,i,o,l,c,u,d=0;d<t.length&&!c;){var f=t[d],h=t[d+1];for(r=i=0;r<f.length&&!c;)if(c=f[r++].exec(e))for(o=0;o<h.length;o++)u=c[++i],typeof(l=h[o])===a&&l.length>0?2===l.length?typeof l[1]==s?this[l[0]]=l[1].call(this,u):this[l[0]]=l[1]:3===l.length?typeof l[1]!==s||l[1].exec&&l[1].test?this[l[0]]=u?u.replace(l[1],l[2]):n:this[l[0]]=u?l[1].call(this,u,l[2]):n:4===l.length&&(this[l[0]]=u?l[3].call(this,u.replace(l[1],l[2])):n):this[l]=u||n;d+=2}},z=function(e,t){for(var r in t)if(typeof t[r]===a&&t[r].length>0){for(var s=0;s<t[r].length;s++)if(F(t[r][s],e))return"?"===r?n:r}else if(F(t[r],e))return"?"===r?n:r;return e},L={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},M={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[c,f],[/opios[\/ ]+([\w\.]+)/i],[f,[c,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[f,[c,O]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[c,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[f,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure Browser"],f],[/\bfocus\/([\w\.]+)/i],[f,[c,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[f,[c,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[c,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[c,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[f,[c,j]],[/\bqihu|(qi?ho?o?|360)browser/i],[[c,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 Browser"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[c,f],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[c,B],f],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[c,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[c,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[c,"Chrome WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[c,f],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[f,[c,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[f,c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[c,[f,z,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[c,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[c,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[c,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,J]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows (ce|mobile); ppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[h,/ower/,"",J]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,J]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[d,U],[u,w]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[d,U],[u,p]],[/\((ip(?:hone|od)[\w ]*);/i],[l,[d,v],[u,p]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[d,v],[u,w]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[d,S],[u,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[l,[d,S],[u,p]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[d,V],[u,p]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[d,V],[u,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[d,"OPPO"],[u,p]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[d,"Vivo"],[u,p]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[l,[d,"Realme"],[u,p]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[d,I],[u,p]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[d,I],[u,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[d,T],[u,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[d,T],[u,p]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[d,"Lenovo"],[u,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[d,"Nokia"],[u,p]],[/(pixel c)\b/i],[l,[d,A],[u,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[d,A],[u,p]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[d,R],[u,p]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[d,R],[u,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[d,"OnePlus"],[u,p]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[d,y],[u,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[d,y],[u,p]],[/(playbook);[-\w\),; ]+(rim)/i],[l,d,[u,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[d,k],[u,p]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[d,x],[u,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[d,x],[u,p]],[/(nexus 9)/i],[l,[d,"HTC"],[u,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[d,[l,/_/g," "],[u,p]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[d,"Acer"],[u,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[d,"Meizu"],[u,p]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[d,"Sharp"],[u,p]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,l,[u,p]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,l,[u,w]],[/(surface duo)/i],[l,[d,E],[u,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[d,"Fairphone"],[u,p]],[/(u304aa)/i],[l,[d,"AT&T"],[u,p]],[/\bsie-(\w*)/i],[l,[d,"Siemens"],[u,p]],[/\b(rct\w+) b/i],[l,[d,"RCA"],[u,w]],[/\b(venue[\d ]{2,7}) b/i],[l,[d,"Dell"],[u,w]],[/\b(q(?:mv|ta)\w+) b/i],[l,[d,"Verizon"],[u,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[d,"Barnes & Noble"],[u,w]],[/\b(tm\d{3}\w+) b/i],[l,[d,"NuVision"],[u,w]],[/\b(k88) b/i],[l,[d,"ZTE"],[u,w]],[/\b(nx\d{3}j) b/i],[l,[d,"ZTE"],[u,p]],[/\b(gen\d{3}) b.+49h/i],[l,[d,"Swiss"],[u,p]],[/\b(zur\d{3}) b/i],[l,[d,"Swiss"],[u,w]],[/\b((zeki)?tb.*\b) b/i],[l,[d,"Zeki"],[u,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],l,[u,w]],[/\b(ns-?\w{0,9}) b/i],[l,[d,"Insignia"],[u,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[d,"NextBook"],[u,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],l,[u,p]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],l,[u,p]],[/\b(ph-1) /i],[l,[d,"Essential"],[u,p]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[d,"Envizen"],[u,w]],[/\b(trio[-\w\. ]+) b/i],[l,[d,"MachSpeed"],[u,w]],[/\btu_(1491) b/i],[l,[d,"Rotor"],[u,w]],[/(shield[\w ]+) b/i],[l,[d,"Nvidia"],[u,w]],[/(sprint) (\w+)/i],[d,l,[u,p]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[d,E],[u,p]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[d,P],[u,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[d,P],[u,p]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,l,[u,b]],[/droid.+; (shield) bui/i],[l,[d,"Nvidia"],[u,b]],[/(playstation [345portablevi]+)/i],[l,[d,R],[u,b]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[d,E],[u,b]],[/smart-tv.+(samsung)/i],[d,[u,g]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[d,U],[u,g]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,T],[u,g]],[/(apple) ?tv/i],[d,[l,"Apple TV"],[u,g]],[/crkey/i],[[l,"Chromecast"],[d,A],[u,g]],[/droid.+aft(\w)( bui|\))/i],[l,[d,y],[u,g]],[/\(dtv[\);].+(aquos)/i],[l,[d,"Sharp"],[u,g]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[d,D],[l,D],[u,g]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,g]],[/((pebble))app/i],[d,l,[u,m]],[/droid.+; (glass) \d/i],[l,[d,A],[u,m]],[/droid.+; (wt63?0{2,3})\)/i],[l,[d,P],[u,m]],[/(quest( 2)?)/i],[l,[d,B],[u,m]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[u,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[l,[u,p]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[u,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,w]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[u,p]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[c,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,c]],os:[[/microsoft (windows) (vista|xp)/i],[c,f],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[c,[f,z,L]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[c,"Windows"],[f,z,L]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[c,"Mac OS"],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[f,c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[c,f],[/\(bb(10);/i],[f,[c,k]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[c,"webOS"]],[/crkey\/([\d\.]+)/i],[f,[c,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[c,"Chromium OS"],f],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[c,f],[/(sunos) ?([\w\.\d]*)/i],[[c,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[c,f]]},q=function(e,t){if(typeof e===a&&(t=e,e=n),!(this instanceof q))return new q(e,t).getResult();var s=e||(typeof r!==i&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),l=t?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(M,t):M;return this.getBrowser=function(){var e,t={};return t.name=n,t.version=n,N.call(t,s,l.browser),t.major=typeof(e=t.version)===o?e.replace(/[^\d\.]/g,"").split(".")[0]:n,t},this.getCPU=function(){var e={};return e.architecture=n,N.call(e,s,l.cpu),e},this.getDevice=function(){var e={};return e.vendor=n,e.model=n,e.type=n,N.call(e,s,l.device),e},this.getEngine=function(){var e={};return e.name=n,e.version=n,N.call(e,s,l.engine),e},this.getOS=function(){var e={};return e.name=n,e.version=n,N.call(e,s,l.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return s},this.setUA=function(e){return s=typeof e===o&&e.length>255?D(e,255):e,this},this.setUA(s),this};q.VERSION="1.0.2",q.BROWSER=C([c,f,"major"]),q.CPU=C([h]),q.DEVICE=C([l,d,u,b,p,g,w,m,_]),q.ENGINE=q.OS=C([c,f]),typeof t!==i?(e.exports&&(t=e.exports=q),t.UAParser=q):typeof define===s&&define.amd?define((function(){return q})):typeof r!==i&&(r.UAParser=q);var W=typeof r!==i&&(r.jQuery||r.Zepto);if(W&&!W.ua){var G=new q;W.ua=G.getResult(),W.ua.get=function(){return G.getUA()},W.ua.set=function(e){G.setUA(e);var t=G.getResult();for(var r in t)W.ua[r]=t[r]}}}("object"==typeof window?window:this)})),s("27Lyk").register(JSON.parse('{"1LzKV":"index.b971d4f8.js","3YKzz":"optcarrot.worker.3977d21b.js"}'));const i=Symbol("Comlink.proxy"),a=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),l=Symbol("Comlink.thrown"),c=e=>"object"==typeof e&&null!==e||"function"==typeof e,u=new Map([["proxy",{canHandle:e=>c(e)&&e[i],serialize(e){const{port1:t,port2:r}=new MessageChannel;return d(e,t),[r,[r]]},deserialize:e=>(e.start(),h(e))}],["throw",{canHandle:e=>c(e)&&l in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function d(e,t=self){t.addEventListener("message",(function r(n){if(!n||!n.data)return;const{id:s,type:i,path:a}=Object.assign({path:[]},n.data),o=(n.data.argumentList||[]).map(v);let c;try{const t=a.slice(0,-1).reduce(((e,t)=>e[t]),e),r=a.reduce(((e,t)=>e[t]),e);switch(i){case"GET":c=r;break;case"SET":t[a.slice(-1)[0]]=v(n.data.value),c=!0;break;case"APPLY":c=r.apply(t,o);break;case"CONSTRUCT":c=_(new r(...o));break;case"ENDPOINT":{const{port1:t,port2:r}=new MessageChannel;d(e,r),c=m(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(e){c={value:e,[l]:0}}Promise.resolve(c).catch((e=>({value:e,[l]:0}))).then((e=>{const[n,a]=y(e);t.postMessage(Object.assign(Object.assign({},n),{id:s}),a),"RELEASE"===i&&(t.removeEventListener("message",r),f(t))}))})),t.start&&t.start()}function f(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function h(e,t){return p(e,[],t)}function b(e){if(e)throw new Error("Proxy has been released and is not useable")}function p(e,t=[],r=function(){}){let n=!1;const s=new Proxy(r,{get(r,i){if(b(n),i===o)return()=>x(e,{type:"RELEASE",path:t.map((e=>e.toString()))}).then((()=>{f(e),n=!0}));if("then"===i){if(0===t.length)return{then:()=>s};const r=x(e,{type:"GET",path:t.map((e=>e.toString()))}).then(v);return r.then.bind(r)}return p(e,[...t,i])},set(r,s,i){b(n);const[a,o]=y(i);return x(e,{type:"SET",path:[...t,s].map((e=>e.toString())),value:a},o).then(v)},apply(r,s,i){b(n);const o=t[t.length-1];if(o===a)return x(e,{type:"ENDPOINT"}).then(v);if("bind"===o)return p(e,t.slice(0,-1));const[l,c]=w(i);return x(e,{type:"APPLY",path:t.map((e=>e.toString())),argumentList:l},c).then(v)},construct(r,s){b(n);const[i,a]=w(s);return x(e,{type:"CONSTRUCT",path:t.map((e=>e.toString())),argumentList:i},a).then(v)}});return s}function w(e){const t=e.map(y);return[t.map((e=>e[0])),(r=t.map((e=>e[1])),Array.prototype.concat.apply([],r))];var r}const g=new WeakMap;function m(e,t){return g.set(e,t),e}function _(e){return Object.assign(e,{[i]:!0})}function y(e){for(const[t,r]of u)if(r.canHandle(e)){const[n,s]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},s]}return[{type:"RAW",value:e},g.get(e)||[]]}function v(e){switch(e.type){case"HANDLER":return u.get(e.name).deserialize(e.value);case"RAW":return e.value}}function x(e,t,r){return new Promise((n=>{const s=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===s&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:s},t),r)}))}class k{static read_bytes(e,t){const r=new k;return r.buf=e.getUint32(t,!0),r.buf_len=e.getUint32(t+4,!0),r}static read_bytes_array(e,t,r){const n=[];for(let s=0;s<r;s++)n.push(k.read_bytes(e,t+8*s));return n}}class j{static read_bytes(e,t){const r=new j;return r.buf=e.getUint32(t,!0),r.buf_len=e.getUint32(t+4,!0),r}static read_bytes_array(e,t,r){const n=[];for(let s=0;s<r;s++)n.push(j.read_bytes(e,t+8*s));return n}}class A{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,t){e.setBigUint64(t,this.d_next,!0),e.setBigUint64(t+8,this.d_ino,!0),e.setUint32(t+16,this.dir_name.length,!0),e.setUint8(t+20,this.d_type)}write_name_bytes(e,t,r){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,r)),t)}constructor(e,t,r){this.d_ino=1n;const n=(new TextEncoder).encode(t);this.d_next=e,this.d_namlen=n.byteLength,this.d_type=r,this.dir_name=n}}class S{write_bytes(e,t){e.setUint8(t,this.fs_filetype),e.setUint16(t+2,this.fs_flags,!0),e.setBigUint64(t+8,this.fs_rights_base,!0),e.setBigUint64(t+16,this.fs_rights_inherited,!0)}constructor(e,t){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=t}}class T{write_bytes(e,t){e.setBigUint64(t,this.dev,!0),e.setBigUint64(t+8,this.ino,!0),e.setUint8(t+16,this.filetype),e.setBigUint64(t+24,this.nlink,!0),e.setBigUint64(t+32,this.size,!0),e.setBigUint64(t+38,this.atim,!0),e.setBigUint64(t+46,this.mtim,!0),e.setBigUint64(t+52,this.ctim,!0)}constructor(e,t){this.dev=0n,this.ino=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.filetype=e,this.size=t}}class E{write_bytes(e,t){e.setUint32(t,this.pr_name_len,!0)}constructor(e){this.pr_name_len=e}}class I{static dir(e){const t=new I;return t.tag=0,t.inner=new E(e),t}write_bytes(e,t){e.setUint32(t,this.tag,!0),this.inner.write_bytes(e,t+4)}}const O=new class{enable(e){this.log=function(e,t){if(e){return console.log.bind(console,"%c%s","color: #265BA0",t)}return()=>{}}(void 0===e||e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}}(!1);class U{fd_advise(e,t,r){return-1}fd_allocate(e,t){return-1}fd_close(){return 0}fd_datasync(){return-1}fd_fdstat_get(){return{ret:-1,fdstat:null}}fd_fdstat_set_flags(e){return-1}fd_fdstat_set_rights(e,t){return-1}fd_filestat_get(){return{ret:-1,filestat:null}}fd_filestat_set_size(e){return-1}fd_filestat_set_times(e,t,r){return-1}fd_pread(e,t,r){return{ret:-1,nread:0}}fd_prestat_get(){return{ret:-1,prestat:null}}fd_prestat_dir_name(){return{ret:-1,prestat_dir_name:null}}fd_pwrite(e,t,r){return{ret:-1,nwritten:0}}fd_read(e,t){return{ret:-1,nread:0}}fd_readdir_single(e){return{ret:-1,dirent:null}}fd_seek(e,t){return{ret:-1,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:-1,offset:0n}}fd_write(e,t){return{ret:-1,nwritten:0}}path_create_directory(e){return-1}path_filestat_get(e,t){return{ret:-1,filestat:null}}path_filestat_set_times(e,t,r,n,s){return-1}path_link(e,t,r,n){return-1}path_open(e,t,r,n,s,i){return{ret:-1,fd_obj:null}}path_readlink(e){return{ret:-1,data:null}}path_remove_directory(e){return-1}path_rename(e,t,r){return-1}path_symlink(e,t){return-1}path_unlink_file(e){return-1}}class R extends U{fd_fdstat_get(){return{ret:0,fdstat:new S(4,0)}}fd_read(e,t){let r=0;for(const n of t){if(!(this.file_pos<this.file.data.byteLength))break;{const t=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(n.buf_len)));e.set(t,n.buf),this.file_pos+=BigInt(t.length),r+=t.length}}return{ret:0,nread:r}}fd_pread(e,t,r){let n=0;for(const s of t){if(!(r<this.file.data.byteLength))break;{const t=this.file.data.slice(Number(r),Number(r+BigInt(s.buf_len)));e.set(t,s.buf),r+=BigInt(t.length),n+=t.length}}return{ret:0,nread:n}}fd_seek(e,t){let r;switch(t){case 0:r=e;break;case 1:r=this.file_pos+e;break;case 2:r=BigInt(this.file.data.byteLength)+e;break;default:return{ret:28,offset:0n}}return r<0?{ret:28,offset:0n}:(this.file_pos=r,{ret:0,offset:this.file_pos})}fd_write(e,t){let r=0;if(this.file.readonly)return{ret:8,nwritten:r};for(const n of t){const t=e.slice(n.buf,n.buf+n.buf_len);if(this.file_pos+BigInt(t.byteLength)>this.file.size){const e=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(t.byteLength))),this.file.data.set(e)}this.file.data.set(t.slice(0,Number(this.file.size-this.file_pos)),Number(this.file_pos)),this.file_pos+=BigInt(t.byteLength),r+=n.buf_len}return{ret:0,nwritten:r}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}}class V extends U{fd_fdstat_get(){return{ret:0,fdstat:new S(3,0)}}fd_readdir_single(e){if(O.enabled&&(O.log("readdir_single",e),O.log(e,Object.keys(this.dir.contents))),O.log(e,Object.keys(this.dir.contents).slice(Number(e))),e>=BigInt(Object.keys(this.dir.contents).length))return{ret:0,dirent:null};const t=Object.keys(this.dir.contents)[Number(e)],r=this.dir.contents[t];return{ret:0,dirent:new A(e+1n,t,r.stat().filetype)}}path_filestat_get(e,t){const r=this.dir.get_entry_for_path(t);return null==r?{ret:44,filestat:null}:{ret:0,filestat:r.stat()}}path_open(e,t,r,n,s,i){let a=this.dir.get_entry_for_path(t);if(null==a){if(1!=(1&r))return{ret:44,fd_obj:null};a=this.dir.create_entry_for_path(t,2==(2&r))}else if(4==(4&r))return{ret:20,fd_obj:null};if(2==(2&r)&&3!==a.stat().filetype)return{ret:54,fd_obj:null};if(a.readonly&&(n&BigInt(64))==BigInt(64))return{ret:63,fd_obj:null};if(!(a instanceof C)&&8==(8&r)){const e=a.truncate();if(0!=e)return{ret:e,fd_obj:null}}return{ret:0,fd_obj:a.open(i)}}path_create_directory(e){return this.path_open(0,e,3,0n,0n,0).ret}constructor(e){super(),this.dir=e}}class P extends V{fd_prestat_get(){return{ret:0,prestat:I.dir(this.prestat_name.length)}}fd_prestat_dir_name(){return{ret:0,prestat_dir_name:this.prestat_name}}constructor(e,t){super(new C(t)),this.prestat_name=(new TextEncoder).encode(e)}}class B{open(e){const t=new R(this);return 1&e&&t.fd_seek(0n,2),t}get size(){return BigInt(this.data.byteLength)}stat(){return new T(4,this.size)}truncate(){return this.readonly?63:(this.data=new Uint8Array([]),0)}constructor(e,t){this.data=new Uint8Array(e),this.readonly=!!t?.readonly}}class C{open(e){return new V(this)}stat(){return new T(3,0n)}get_entry_for_path(e){let t=this;for(const r of e.split("/")){if(""==r)break;if("."!=r){if(!(t instanceof C))return null;if(null==t.contents[r])return O.log(r),null;t=t.contents[r]}}return t}create_entry_for_path(e,t){let r=this;const n=e.split("/").filter((e=>"/"!=e));for(let e=0;e<n.length;e++){const s=n[e];if(!(r instanceof C))break;null!=r.contents[s]||(O.log("create",s),e!=n.length-1||t?r.contents[s]=new C({}):r.contents[s]=new B(new ArrayBuffer(0))),r=r.contents[s]}return r}constructor(e){this.readonly=!1,this.contents=e}}let F=new DataView(new ArrayBuffer);function J(e){return F.buffer!==e.buffer&&(F=new DataView(e.buffer)),F}const D=new TextDecoder("utf-8"),N=new TextEncoder("utf-8");function z(e,t,r){if("string"!=typeof e)throw new TypeError("expected a string");if(0===e.length)return L=0,1;let n=0,s=0,i=0;for(;e.length>0;){s=t(s,n,1,n+e.length),n+=e.length;const{read:a,written:o}=N.encodeInto(e,new Uint8Array(r.buffer,s+i,n-i));i+=o,e=e.slice(a)}return n>i&&(s=t(s,n,1,i)),L=i,s}let L=0;class M{constructor(){this.list=[],this.head=0}insert(e){this.head>=this.list.length&&this.list.push({next:this.list.length+1,val:void 0});const t=this.head,r=this.list[t];return this.head=r.next,r.next=-1,r.val=e,t}get(e){if(e>=this.list.length)throw new RangeError("handle index not valid");const t=this.list[e];if(-1===t.next)return t.val;throw new RangeError("handle index not valid")}remove(e){const t=this.get(e),r=this.list[e];return r.val=void 0,r.next=this.head,this.head=e,t}}function q(){throw new RangeError("invalid variant discriminant for bool")}class W{constructor(){this._resource0_slab=new M,this._resource1_slab=new M}addToImports(e){"canonical_abi"in e||(e.canonical_abi={}),e.canonical_abi["resource_drop_rb-iseq"]=e=>{this._resource0_slab.remove(e).drop()},e.canonical_abi["resource_clone_rb-iseq"]=e=>{const t=this._resource0_slab.get(e);return this._resource0_slab.insert(t.clone())},e.canonical_abi["resource_get_rb-iseq"]=e=>this._resource0_slab.get(e)._wasm_val,e.canonical_abi["resource_new_rb-iseq"]=e=>(this._registry0,this._resource0_slab.insert(new G(e,this))),e.canonical_abi["resource_drop_rb-abi-value"]=e=>{this._resource1_slab.remove(e).drop()},e.canonical_abi["resource_clone_rb-abi-value"]=e=>{const t=this._resource1_slab.get(e);return this._resource1_slab.insert(t.clone())},e.canonical_abi["resource_get_rb-abi-value"]=e=>this._resource1_slab.get(e)._wasm_val,e.canonical_abi["resource_new_rb-abi-value"]=e=>(this._registry1,this._resource1_slab.insert(new $(e,this)))}async instantiate(e,t){if(t=t||{},this.addToImports(t),e instanceof WebAssembly.Instance)this.instance=e;else if(e instanceof WebAssembly.Module)this.instance=await WebAssembly.instantiate(e,t);else if(e instanceof ArrayBuffer||e instanceof Uint8Array){const{instance:r}=await WebAssembly.instantiate(e,t);this.instance=r}else{const{instance:r}=await WebAssembly.instantiateStreaming(e,t);this.instance=r}this._exports=this.instance.exports,this._registry0=new FinalizationRegistry(this._exports["canonical_abi_drop_rb-iseq"]),this._registry1=new FinalizationRegistry(this._exports["canonical_abi_drop_rb-abi-value"])}rubyShowVersion(){this._exports["ruby-show-version: func() -> ()"]()}rubyInit(){this._exports["ruby-init: func() -> ()"]()}rubySysinit(e){const t=this._exports.memory,r=this._exports.cabi_realloc,n=e,s=n.length,i=r(0,0,4,8*s);for(let e=0;e<n.length;e++){const s=i+8*e,a=z(n[e],r,t),o=L;J(t).setInt32(s+4,o,!0),J(t).setInt32(s+0,a,!0)}this._exports["ruby-sysinit: func(args: list<string>) -> ()"](i,s)}rubyOptions(e){const t=this._exports.memory,r=this._exports.cabi_realloc,n=e,s=n.length,i=r(0,0,4,8*s);for(let e=0;e<n.length;e++){const s=i+8*e,a=z(n[e],r,t),o=L;J(t).setInt32(s+4,o,!0),J(t).setInt32(s+0,a,!0)}const a=this._exports["ruby-options: func(args: list<string>) -> handle<rb-iseq>"](i,s);return this._resource0_slab.remove(a)}rubyScript(e){const t=this._exports.memory,r=z(e,this._exports.cabi_realloc,t),n=L;this._exports["ruby-script: func(name: string) -> ()"](r,n)}rubyInitLoadpath(){this._exports["ruby-init-loadpath: func() -> ()"]()}rbEvalStringProtect(e){const t=this._exports.memory,r=z(e,this._exports.cabi_realloc,t),n=L,s=this._exports["rb-eval-string-protect: func(str: string) -> tuple<handle<rb-abi-value>, s32>"](r,n);return[this._resource1_slab.remove(J(t).getInt32(s+0,!0)),J(t).getInt32(s+4,!0)]}rbFuncallvProtect(e,t,r){const n=this._exports.memory,s=this._exports.cabi_realloc,i=e;if(!(i instanceof $))throw new TypeError("expected instance of RbAbiValue");const a=r,o=a.length,l=s(0,0,4,4*o);for(let e=0;e<a.length;e++){const t=l+4*e,r=a[e];if(!(r instanceof $))throw new TypeError("expected instance of RbAbiValue");J(n).setInt32(t+0,this._resource1_slab.insert(r.clone()),!0)}const c=this._exports["rb-funcallv-protect: func(recv: handle<rb-abi-value>, mid: u32, args: list<handle<rb-abi-value>>) -> tuple<handle<rb-abi-value>, s32>"](this._resource1_slab.insert(i.clone()),t>>>0,l,o);return[this._resource1_slab.remove(J(n).getInt32(c+0,!0)),J(n).getInt32(c+4,!0)]}rbIntern(e){const t=this._exports.memory,r=z(e,this._exports.cabi_realloc,t),n=L;return this._exports["rb-intern: func(name: string) -> u32"](r,n)>>>0}rbErrinfo(){const e=this._exports["rb-errinfo: func() -> handle<rb-abi-value>"]();return this._resource1_slab.remove(e)}rbClearErrinfo(){this._exports["rb-clear-errinfo: func() -> ()"]()}rstringPtr(e){const t=this._exports.memory,r=e;if(!(r instanceof $))throw new TypeError("expected instance of RbAbiValue");const n=this._exports["rstring-ptr: func(value: handle<rb-abi-value>) -> string"](this._resource1_slab.insert(r.clone())),s=J(t).getInt32(n+0,!0),i=J(t).getInt32(n+4,!0),a=D.decode(new Uint8Array(t.buffer,s,i));return this._exports["cabi_post_rstring-ptr"](n),a}rbVmBugreport(){this._exports["rb-vm-bugreport: func() -> ()"]()}rbGcEnable(){const e=this._exports["rb-gc-enable: func() -> bool"]();return 0!=e&&(1==e||q())}rbGcDisable(){const e=this._exports["rb-gc-disable: func() -> bool"]();return 0!=e&&(1==e||q())}rbSetShouldProhibitRewind(e){const t=this._exports["rb-set-should-prohibit-rewind: func(new-value: bool) -> bool"](e?1:0);return 0!=t&&(1==t||q())}}class G{constructor(e,t){this._wasm_val=e,this._obj=t,this._refcnt=1,t._registry0.register(this,e,this)}clone(){return this._refcnt+=1,this}drop(){if(this._refcnt-=1,0!==this._refcnt)return;this._obj._registry0.unregister(this);const e=this._obj._exports["canonical_abi_drop_rb-iseq"],t=this._wasm_val;delete this._obj,delete this._refcnt,delete this._wasm_val,e(t)}}class ${constructor(e,t){this._wasm_val=e,this._obj=t,this._refcnt=1,t._registry1.register(this,e,this)}clone(){return this._refcnt+=1,this}drop(){if(this._refcnt-=1,0!==this._refcnt)return;this._obj._registry1.unregister(this);const e=this._obj._exports["canonical_abi_drop_rb-abi-value"],t=this._wasm_val;delete this._obj,delete this._refcnt,delete this._wasm_val,e(t)}}class H{constructor(){this.instance=null,this.interfaceState={hasJSFrameAfterRbFrame:!1};this.guest=(e=>{const t=["constructor"].concat(["addToImports","instantiate","rbSetShouldProhibitRewind","rbGcDisable","rbGcEnable"]);for(const r of Object.getOwnPropertyNames(W.prototype)){if(t.includes(r))continue;const n=e[r];"function"==typeof n&&(e[r]=(...t)=>{if(this.interfaceState.hasJSFrameAfterRbFrame){const r=this.guest.rbSetShouldProhibitRewind(!0),s=this.guest.rbGcDisable(),i=Reflect.apply(n,e,t);return this.guest.rbSetShouldProhibitRewind(r),s||this.guest.rbGcEnable(),i}return Reflect.apply(n,e,t)})}return e})(new W),this.transport=new K,this.exceptionFormatter=new Q}initialize(e=["ruby.wasm","--disable-gems","-EUTF-8","-e_=0"]){const t=e.map((e=>e+"\0"));this.guest.rubyInit(),this.guest.rubySysinit(t),this.guest.rubyOptions(t)}async setInstance(e){this.instance=e,await this.guest.instantiate(e)}addToImports(e){function r(e){return(...t)=>{try{return{tag:"success",val:e(...t)}}catch(e){if(e instanceof ie)throw e;return{tag:"failure",val:e}}}}this.guest.addToImports(e),e["rb-js-abi-host"]={rb_wasm_throw_prohibit_rewind_exception:(e,t)=>{const r=this.instance.exports.memory,n=(new TextDecoder).decode(new Uint8Array(r.buffer,e,t));throw new ie(`Ruby APIs that may rewind the VM stack are prohibited under nested VM operation (${n})\nNested VM operation means that the call stack has sandwitched JS frames like JS -> Ruby -> JS -> Ruby caused by something like \`window.rubyVM.eval("JS.global[:rubyVM].eval('Fiber.yield')")\`\n\nPlease check your call stack and make sure that you are **not** doing any of the following inside the nested Ruby frame:\n  1. Switching fibers (e.g. Fiber#resume, Fiber.yield, and Fiber#transfer)\n     Note that \`evalAsync\` JS API switches fibers internally\n  2. Raising uncaught exceptions\n     Please catch all exceptions inside the nested operation\n  3. Calling Continuation APIs\n`)}};!function(e,t,r){"rb-js-abi-host"in e||(e["rb-js-abi-host"]={}),e["rb-js-abi-host"]["eval-js: func(code: string) -> variant { success(handle<js-abi-value>), failure(handle<js-abi-value>) }"]=function(e,s,i){const a=r("memory"),o=e,l=s,c=D.decode(new Uint8Array(a.buffer,o,l)),u=t.evalJs(c);switch(u.tag){case"success":{const e=u.val;J(a).setInt8(i+0,0,!0),J(a).setInt32(i+4,n.insert(e),!0);break}case"failure":{const e=u.val;J(a).setInt8(i+0,1,!0),J(a).setInt32(i+4,n.insert(e),!0);break}default:throw new RangeError("invalid variant specified for JsAbiResult")}},e["rb-js-abi-host"]["is-js: func(value: handle<js-abi-value>) -> bool"]=function(e){return t.isJs(n.get(e))?1:0},e["rb-js-abi-host"]["instance-of: func(value: handle<js-abi-value>, klass: handle<js-abi-value>) -> bool"]=function(e,r){return t.instanceOf(n.get(e),n.get(r))?1:0},e["rb-js-abi-host"]["global-this: func() -> handle<js-abi-value>"]=function(){const e=t.globalThis();return n.insert(e)},e["rb-js-abi-host"]["int-to-js-number: func(value: s32) -> handle<js-abi-value>"]=function(e){const r=t.intToJsNumber(e);return n.insert(r)},e["rb-js-abi-host"]["float-to-js-number: func(value: float64) -> handle<js-abi-value>"]=function(e){const r=t.floatToJsNumber(e);return n.insert(r)},e["rb-js-abi-host"]["string-to-js-string: func(value: string) -> handle<js-abi-value>"]=function(e,s){const i=r("memory"),a=e,o=s,l=D.decode(new Uint8Array(i.buffer,a,o)),c=t.stringToJsString(l);return n.insert(c)},e["rb-js-abi-host"]["bool-to-js-bool: func(value: bool) -> handle<js-abi-value>"]=function(e){const r=e,s=t.boolToJsBool(0!=r&&(1==r||q()));return n.insert(s)},e["rb-js-abi-host"]["proc-to-js-function: func(value: u32) -> handle<js-abi-value>"]=function(e){const r=t.procToJsFunction(e>>>0);return n.insert(r)},e["rb-js-abi-host"]["rb-object-to-js-rb-value: func(raw-rb-abi-value: u32) -> handle<js-abi-value>"]=function(e){const r=t.rbObjectToJsRbValue(e>>>0);return n.insert(r)},e["rb-js-abi-host"]["js-value-to-string: func(value: handle<js-abi-value>) -> string"]=function(e,s){const i=r("memory"),a=r("cabi_realloc"),o=z(t.jsValueToString(n.get(e)),a,i),l=L;J(i).setInt32(s+4,l,!0),J(i).setInt32(s+0,o,!0)},e["rb-js-abi-host"]["js-value-to-integer: func(value: handle<js-abi-value>) -> variant { f64(float64), bignum(string) }"]=function(e,s){const i=r("memory"),a=r("cabi_realloc"),o=t.jsValueToInteger(n.get(e));switch(o.tag){case"f64":{const e=o.val;J(i).setInt8(s+0,0,!0),J(i).setFloat64(s+8,+e,!0);break}case"bignum":{const e=o.val;J(i).setInt8(s+0,1,!0);const t=z(e,a,i),r=L;J(i).setInt32(s+12,r,!0),J(i).setInt32(s+8,t,!0);break}default:throw new RangeError("invalid variant specified for RawInteger")}},e["rb-js-abi-host"]["export-js-value-to-host: func(value: handle<js-abi-value>) -> ()"]=function(e){t.exportJsValueToHost(n.get(e))},e["rb-js-abi-host"]["import-js-value-from-host: func() -> handle<js-abi-value>"]=function(){const e=t.importJsValueFromHost();return n.insert(e)},e["rb-js-abi-host"]["js-value-typeof: func(value: handle<js-abi-value>) -> string"]=function(e,s){const i=r("memory"),a=r("cabi_realloc"),o=z(t.jsValueTypeof(n.get(e)),a,i),l=L;J(i).setInt32(s+4,l,!0),J(i).setInt32(s+0,o,!0)},e["rb-js-abi-host"]["js-value-equal: func(lhs: handle<js-abi-value>, rhs: handle<js-abi-value>) -> bool"]=function(e,r){return t.jsValueEqual(n.get(e),n.get(r))?1:0},e["rb-js-abi-host"]["js-value-strictly-equal: func(lhs: handle<js-abi-value>, rhs: handle<js-abi-value>) -> bool"]=function(e,r){return t.jsValueStrictlyEqual(n.get(e),n.get(r))?1:0},e["rb-js-abi-host"]["reflect-apply: func(target: handle<js-abi-value>, this-argument: handle<js-abi-value>, arguments: list<handle<js-abi-value>>) -> variant { success(handle<js-abi-value>), failure(handle<js-abi-value>) }"]=function(e,s,i,a,o){const l=r("memory"),c=a,u=i,d=[];for(let e=0;e<c;e++){const t=u+4*e;d.push(n.get(J(l).getInt32(t+0,!0)))}const f=t.reflectApply(n.get(e),n.get(s),d);switch(f.tag){case"success":{const e=f.val;J(l).setInt8(o+0,0,!0),J(l).setInt32(o+4,n.insert(e),!0);break}case"failure":{const e=f.val;J(l).setInt8(o+0,1,!0),J(l).setInt32(o+4,n.insert(e),!0);break}default:throw new RangeError("invalid variant specified for JsAbiResult")}},e["rb-js-abi-host"]["reflect-construct: func(target: handle<js-abi-value>, arguments: list<handle<js-abi-value>>) -> handle<js-abi-value>"]=function(e,s,i){const a=r("memory"),o=i,l=s,c=[];for(let e=0;e<o;e++){const t=l+4*e;c.push(n.get(J(a).getInt32(t+0,!0)))}const u=t.reflectConstruct(n.get(e),c);return n.insert(u)},e["rb-js-abi-host"]["reflect-delete-property: func(target: handle<js-abi-value>, property-key: string) -> bool"]=function(e,s,i){const a=r("memory"),o=s,l=i,c=D.decode(new Uint8Array(a.buffer,o,l));return t.reflectDeleteProperty(n.get(e),c)?1:0},e["rb-js-abi-host"]["reflect-get: func(target: handle<js-abi-value>, property-key: string) -> variant { success(handle<js-abi-value>), failure(handle<js-abi-value>) }"]=function(e,s,i,a){const o=r("memory"),l=s,c=i,u=D.decode(new Uint8Array(o.buffer,l,c)),d=t.reflectGet(n.get(e),u);switch(d.tag){case"success":{const e=d.val;J(o).setInt8(a+0,0,!0),J(o).setInt32(a+4,n.insert(e),!0);break}case"failure":{const e=d.val;J(o).setInt8(a+0,1,!0),J(o).setInt32(a+4,n.insert(e),!0);break}default:throw new RangeError("invalid variant specified for JsAbiResult")}},e["rb-js-abi-host"]["reflect-get-own-property-descriptor: func(target: handle<js-abi-value>, property-key: string) -> handle<js-abi-value>"]=function(e,s,i){const a=r("memory"),o=s,l=i,c=D.decode(new Uint8Array(a.buffer,o,l)),u=t.reflectGetOwnPropertyDescriptor(n.get(e),c);return n.insert(u)},e["rb-js-abi-host"]["reflect-get-prototype-of: func(target: handle<js-abi-value>) -> handle<js-abi-value>"]=function(e){const r=t.reflectGetPrototypeOf(n.get(e));return n.insert(r)},e["rb-js-abi-host"]["reflect-has: func(target: handle<js-abi-value>, property-key: string) -> bool"]=function(e,s,i){const a=r("memory"),o=s,l=i,c=D.decode(new Uint8Array(a.buffer,o,l));return t.reflectHas(n.get(e),c)?1:0},e["rb-js-abi-host"]["reflect-is-extensible: func(target: handle<js-abi-value>) -> bool"]=function(e){return t.reflectIsExtensible(n.get(e))?1:0},e["rb-js-abi-host"]["reflect-own-keys: func(target: handle<js-abi-value>) -> list<handle<js-abi-value>>"]=function(e,s){const i=r("memory"),a=r("cabi_realloc"),o=t.reflectOwnKeys(n.get(e)),l=o.length,c=a(0,0,4,4*l);for(let e=0;e<o.length;e++){const t=o[e],r=c+4*e;J(i).setInt32(r+0,n.insert(t),!0)}J(i).setInt32(s+4,l,!0),J(i).setInt32(s+0,c,!0)},e["rb-js-abi-host"]["reflect-prevent-extensions: func(target: handle<js-abi-value>) -> bool"]=function(e){return t.reflectPreventExtensions(n.get(e))?1:0},e["rb-js-abi-host"]["reflect-set: func(target: handle<js-abi-value>, property-key: string, value: handle<js-abi-value>) -> variant { success(handle<js-abi-value>), failure(handle<js-abi-value>) }"]=function(e,s,i,a,o){const l=r("memory"),c=s,u=i,d=D.decode(new Uint8Array(l.buffer,c,u)),f=t.reflectSet(n.get(e),d,n.get(a));switch(f.tag){case"success":{const e=f.val;J(l).setInt8(o+0,0,!0),J(l).setInt32(o+4,n.insert(e),!0);break}case"failure":{const e=f.val;J(l).setInt8(o+0,1,!0),J(l).setInt32(o+4,n.insert(e),!0);break}default:throw new RangeError("invalid variant specified for JsAbiResult")}},e["rb-js-abi-host"]["reflect-set-prototype-of: func(target: handle<js-abi-value>, prototype: handle<js-abi-value>) -> bool"]=function(e,r){return t.reflectSetPrototypeOf(n.get(e),n.get(r))?1:0},"canonical_abi"in e||(e.canonical_abi={});const n=new M;e.canonical_abi["resource_drop_js-abi-value"]=e=>{const r=n.remove(e);t.dropJsAbiValue&&t.dropJsAbiValue(r)}}(e,(e=>{for(const[t,r]of Object.entries(e))"function"==typeof r&&(e[t]=(...t)=>{const n=this.interfaceState.hasJSFrameAfterRbFrame;this.interfaceState.hasJSFrameAfterRbFrame=!0;const s=Reflect.apply(r,e,t);return this.interfaceState.hasJSFrameAfterRbFrame=n,s});return e})({evalJs:r((e=>Function(e)())),isJs:e=>!0,globalThis:()=>{if("undefined"!=typeof globalThis)return globalThis;if(void 0!==t)return t;if("undefined"!=typeof window)return window;throw new Error("unable to locate global object")},intToJsNumber:e=>e,floatToJsNumber:e=>e,stringToJsString:e=>e,boolToJsBool:e=>e,procToJsFunction:e=>{const t=this.rbValueOfPointer(e);return(...e)=>{t.call("call",...e.map((e=>this.wrap(e))))}},rbObjectToJsRbValue:e=>this.rbValueOfPointer(e),jsValueToString:e=>String(e),jsValueToInteger:e=>"number"==typeof e?{tag:"f64",val:e}:"bigint"==typeof e?{tag:"bignum",val:BigInt(e).toString(10)+"\0"}:"string"==typeof e?{tag:"bignum",val:e+"\0"}:void 0===e?{tag:"f64",val:0}:{tag:"f64",val:Number(e)},exportJsValueToHost:e=>{this.transport.takeJsValue(e)},importJsValueFromHost:()=>this.transport.consumeJsValue(),instanceOf:(e,t)=>"function"==typeof t&&e instanceof t,jsValueTypeof:e=>typeof e,jsValueEqual:(e,t)=>e==t,jsValueStrictlyEqual:(e,t)=>e===t,reflectApply:r(((e,t,r)=>Reflect.apply(e,t,r))),reflectConstruct:function(e,t){throw new Error("Function not implemented.")},reflectDeleteProperty:function(e,t){throw new Error("Function not implemented.")},reflectGet:r(((e,t)=>e[t])),reflectGetOwnPropertyDescriptor:function(e,t){throw new Error("Function not implemented.")},reflectGetPrototypeOf:function(e){throw new Error("Function not implemented.")},reflectHas:function(e,t){throw new Error("Function not implemented.")},reflectIsExtensible:function(e){throw new Error("Function not implemented.")},reflectOwnKeys:function(e){throw new Error("Function not implemented.")},reflectPreventExtensions:function(e){throw new Error("Function not implemented.")},reflectSet:r(((e,t,r)=>Reflect.set(e,t,r))),reflectSetPrototypeOf:function(e,t){throw new Error("Function not implemented.")}}),(e=>this.instance.exports[e]))}printVersion(){this.guest.rubyShowVersion()}eval(e){return ne(this,this.privateObject(),e)}evalAsync(e){const t=this.eval("require 'js'; JS");return new Promise(((r,n)=>{t.call("__eval_async_rb",this.wrap(e),this.wrap({resolve:r,reject:e=>{n(new se(this.exceptionFormatter.format(e,this,this.privateObject())))}}))}))}wrap(e){return this.transport.importJsValue(e,this)}privateObject(){return{transport:this.transport,exceptionFormatter:this.exceptionFormatter}}rbValueOfPointer(e){const t=new $(e,this.guest);return new X(t,this,this.privateObject())}}class K{constructor(){this._takenJsValue=null}takeJsValue(e){this._takenJsValue=e}consumeJsValue(){return this._takenJsValue}exportJsValue(e){return e.call("__export_to_js"),this._takenJsValue}importJsValue(e,t){return this._takenJsValue=e,t.eval('require "js"; JS::Object').call("__import_from_js")}}class X{constructor(e,t,r){this.inner=e,this.vm=t,this.privateObject=r}call(e,...t){const r=t.map((e=>e.inner));return new X(re(this.vm,this.privateObject,this.inner,e,r),this.vm,this.privateObject)}[Symbol.toPrimitive](e){return"string"===e||"default"===e?this.toString():null}toString(){const e=re(this.vm,this.privateObject,this.inner,"to_s",[]);return this.vm.guest.rstringPtr(e)}toJS(){const e=this.vm.eval("JS").call("try_convert",this);return"true"===e.call("nil?").toString()?null:this.privateObject.transport.exportJsValue(e)}}var Z,Y;(Y=Z||(Z={}))[Y.None=0]="None",Y[Y.Return=1]="Return",Y[Y.Break=2]="Break",Y[Y.Next=3]="Next",Y[Y.Retry=4]="Retry",Y[Y.Redo=5]="Redo",Y[Y.Raise=6]="Raise",Y[Y.Throw=7]="Throw",Y[Y.Fatal=8]="Fatal",Y[Y.Mask=15]="Mask";class Q{constructor(){this.literalsCache=null}format(e,t,r){const[n,s,i]=(()=>{if(null==this.literalsCache){const e=[ne(t,r,"0"),ne(t,r,"1"),ne(t,r,'"\n"')];return this.literalsCache=e,e}return this.literalsCache})(),a=e.call("backtrace");if("true"===a.call("nil?").toString())return this.formatString(e.call("class").toString(),e.toString());const o=a.call("at",n),l=a.call("drop",s).call("join",i);return this.formatString(e.call("class").toString(),e.toString(),[o.toString(),l.toString()])}formatString(e,t,r){return r?`${r[0]}: ${t} (${e})\n${r[1]}`:`${e}: ${t}`}}const ee=(e,t,r)=>{switch(e&Z.Mask){case Z.None:break;case Z.Return:throw new se("unexpected return");case Z.Next:throw new se("unexpected next");case Z.Break:throw new se("unexpected break");case Z.Redo:throw new se("unexpected redo");case Z.Retry:throw new se("retry outside of rescue clause");case Z.Throw:throw new se("unexpected throw");case Z.Raise:case Z.Fatal:const n=new X(t.guest.rbErrinfo(),t,r);if("true"===n.call("nil?").toString())throw new se("no exception object");throw t.guest.rbClearErrinfo(),new se(r.exceptionFormatter.format(n,t,r));default:throw new se(`unknown error tag: ${e}`)}};function te(e,t){try{return t()}catch(t){if(t instanceof se)throw t;if(e.guest.rbVmBugreport(),t instanceof WebAssembly.RuntimeError&&"unreachable"===t.message){const e=new se(`Something went wrong in Ruby VM: ${t}`);throw e.stack=t.stack,e}throw t}}const re=(e,t,r,n,s)=>{const i=e.guest.rbIntern(n+"\0");return te(e,(()=>{const[n,a]=e.guest.rbFuncallvProtect(r,i,s);return ee(a,e,t),n}))},ne=(e,t,r)=>te(e,(()=>{const[n,s]=e.guest.rbEvalStringProtect(r+"\0");return ee(s,e,t),new X(n,e,t)}));class se extends Error{constructor(e){super(e)}}class ie extends se{constructor(e){super("Ruby Fatal Error: "+e)}}class ae{constructor(e){this.buffer=e}consume(){return 0===this.buffer.length?null:this.buffer.shift()}push(e,t){this.buffer.push([e,t])}}class oe{constructor(){this.rootFs={};const e={};e.OPTCARROT_TMP=new C({}),this.rootFs=e;this.wasi=new class{start(e){this.inst=e,e.exports._start()}initialize(e){this.inst=e,e.exports._initialize()}constructor(e,t,r,n={}){this.args=[],this.env=[],this.fds=[],O.enable(n.debug),this.args=e,this.env=t,this.fds=r;const s=this;this.wasiImport={args_sizes_get(e,t){const r=new DataView(s.inst.exports.memory.buffer);r.setUint32(e,s.args.length,!0);let n=0;for(const e of s.args)n+=e.length+1;return r.setUint32(t,n,!0),O.log(r.getUint32(e,!0),r.getUint32(t,!0)),0},args_get(e,t){const r=new DataView(s.inst.exports.memory.buffer),n=new Uint8Array(s.inst.exports.memory.buffer),i=t;for(let i=0;i<s.args.length;i++){r.setUint32(e,t,!0),e+=4;const a=(new TextEncoder).encode(s.args[i]);n.set(a,t),r.setUint8(t+a.length,0),t+=a.length+1}return O.enabled&&O.log(new TextDecoder("utf-8").decode(n.slice(i,t))),0},environ_sizes_get(e,t){const r=new DataView(s.inst.exports.memory.buffer);r.setUint32(e,s.env.length,!0);let n=0;for(const e of s.env)n+=e.length+1;return r.setUint32(t,n,!0),O.log(r.getUint32(e,!0),r.getUint32(t,!0)),0},environ_get(e,t){const r=new DataView(s.inst.exports.memory.buffer),n=new Uint8Array(s.inst.exports.memory.buffer),i=t;for(let i=0;i<s.env.length;i++){r.setUint32(e,t,!0),e+=4;const a=(new TextEncoder).encode(s.env[i]);n.set(a,t),r.setUint8(t+a.length,0),t+=a.length+1}return O.enabled&&O.log(new TextDecoder("utf-8").decode(n.slice(i,t))),0},clock_res_get(e,t){throw"unimplemented"},clock_time_get(e,t,r){const n=new DataView(s.inst.exports.memory.buffer);if(0===e)n.setBigUint64(r,1000000n*BigInt((new Date).getTime()),!0);else if(1==e){let e;try{e=BigInt(Math.round(1e6*performance.now()))}catch(t){e=0n}n.setBigUint64(r,e,!0)}else n.setBigUint64(r,0n,!0);return 0},fd_advise:(e,t,r,n)=>null!=s.fds[e]?s.fds[e].fd_advise(t,r,n):8,fd_allocate:(e,t,r)=>null!=s.fds[e]?s.fds[e].fd_allocate(t,r):8,fd_close(e){if(null!=s.fds[e]){const t=s.fds[e].fd_close();return s.fds[e]=void 0,t}return 8},fd_datasync:e=>null!=s.fds[e]?s.fds[e].fd_datasync():8,fd_fdstat_get(e,t){if(null!=s.fds[e]){const{ret:r,fdstat:n}=s.fds[e].fd_fdstat_get();return null!=n&&n.write_bytes(new DataView(s.inst.exports.memory.buffer),t),r}return 8},fd_fdstat_set_flags:(e,t)=>null!=s.fds[e]?s.fds[e].fd_fdstat_set_flags(t):8,fd_fdstat_set_rights:(e,t,r)=>null!=s.fds[e]?s.fds[e].fd_fdstat_set_rights(t,r):8,fd_filestat_get(e,t){if(null!=s.fds[e]){const{ret:r,filestat:n}=s.fds[e].fd_filestat_get();return null!=n&&n.write_bytes(new DataView(s.inst.exports.memory.buffer),t),r}return 8},fd_filestat_set_size:(e,t)=>null!=s.fds[e]?s.fds[e].fd_filestat_set_size(t):8,fd_filestat_set_times:(e,t,r,n)=>null!=s.fds[e]?s.fds[e].fd_filestat_set_times(t,r,n):8,fd_pread(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const l=k.read_bytes_array(a,t,r),{ret:c,nread:u}=s.fds[e].fd_pread(o,l,n);return a.setUint32(i,u,!0),c}return 8},fd_prestat_get(e,t){const r=new DataView(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const{ret:n,prestat:i}=s.fds[e].fd_prestat_get();return null!=i&&i.write_bytes(r,t),n}return 8},fd_prestat_dir_name(e,t,r){if(null!=s.fds[e]){const{ret:r,prestat_dir_name:n}=s.fds[e].fd_prestat_dir_name();return null!=n&&new Uint8Array(s.inst.exports.memory.buffer).set(n,t),r}return 8},fd_pwrite(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const l=j.read_bytes_array(a,t,r),{ret:c,nwritten:u}=s.fds[e].fd_pwrite(o,l,n);return a.setUint32(i,u,!0),c}return 8},fd_read(e,t,r,n){const i=new DataView(s.inst.exports.memory.buffer),a=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const o=k.read_bytes_array(i,t,r),{ret:l,nread:c}=s.fds[e].fd_read(a,o);return i.setUint32(n,c,!0),l}return 8},fd_readdir(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){let l=0;for(;;){const{ret:c,dirent:u}=s.fds[e].fd_readdir_single(n);if(0!=c)return a.setUint32(i,l,!0),c;if(null==u)break;if(r-l<u.head_length()){l=r;break}const d=new ArrayBuffer(u.head_length());if(u.write_head_bytes(new DataView(d),0),o.set(new Uint8Array(d).slice(0,Math.min(d.byteLength,r-l)),t),t+=u.head_length(),l+=u.head_length(),r-l<u.name_length()){l=r;break}u.write_name_bytes(o,t,r-l),t+=u.name_length(),l+=u.name_length(),n=u.d_next}return a.setUint32(i,l,!0),0}return 8},fd_renumber(e,t){if(null!=s.fds[e]&&null!=s.fds[t]){const r=s.fds[t].fd_close();return 0!=r?r:(s.fds[t]=s.fds[e],s.fds[e]=void 0,0)}return 8},fd_seek(e,t,r,n){const i=new DataView(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const{ret:a,offset:o}=s.fds[e].fd_seek(t,r);return i.setBigInt64(n,o,!0),a}return 8},fd_sync:e=>null!=s.fds[e]?s.fds[e].fd_sync():8,fd_tell(e,t){const r=new DataView(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const{ret:n,offset:i}=s.fds[e].fd_tell();return r.setBigUint64(t,i,!0),n}return 8},fd_write(e,t,r,n){const i=new DataView(s.inst.exports.memory.buffer),a=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const o=j.read_bytes_array(i,t,r),{ret:l,nwritten:c}=s.fds[e].fd_write(a,o);return i.setUint32(n,c,!0),l}return 8},path_create_directory(e,t,r){const n=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const i=new TextDecoder("utf-8").decode(n.slice(t,t+r));return s.fds[e].path_create_directory(i)}},path_filestat_get(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const l=new TextDecoder("utf-8").decode(o.slice(r,r+n)),{ret:c,filestat:u}=s.fds[e].path_filestat_get(t,l);return null!=u&&u.write_bytes(a,i),c}return 8},path_filestat_set_times(e,t,r,n,i,a,o){const l=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const c=new TextDecoder("utf-8").decode(l.slice(r,r+n));return s.fds[e].path_filestat_set_times(t,c,i,a,o)}return 8},path_link(e,t,r,n,i,a,o){const l=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]&&null!=s.fds[i]){const c=new TextDecoder("utf-8").decode(l.slice(r,r+n)),u=new TextDecoder("utf-8").decode(l.slice(a,a+o));return s.fds[i].path_link(e,t,c,u)}return 8},path_open(e,t,r,n,i,a,o,l,c){const u=new DataView(s.inst.exports.memory.buffer),d=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const f=new TextDecoder("utf-8").decode(d.slice(r,r+n));O.log(f);const{ret:h,fd_obj:b}=s.fds[e].path_open(t,f,i,a,o,l);if(0!=h)return h;s.fds.push(b);const p=s.fds.length-1;return u.setUint32(c,p,!0),0}return 8},path_readlink(e,t,r,n,i,a){const o=new DataView(s.inst.exports.memory.buffer),l=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const c=new TextDecoder("utf-8").decode(l.slice(t,t+r));O.log(c);const{ret:u,data:d}=s.fds[e].path_readlink(c);if(null!=d){if(d.length>i)return o.setUint32(a,0,!0),8;l.set(d,n),o.setUint32(a,d.length,!0)}return u}return 8},path_remove_directory(e,t,r){const n=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const i=new TextDecoder("utf-8").decode(n.slice(t,t+r));return s.fds[e].path_remove_directory(i)}return 8},path_rename(e,t,r,n,s,i){throw"FIXME what is the best abstraction for this?"},path_symlink(e,t,r,n,i){const a=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[r]){const o=new TextDecoder("utf-8").decode(a.slice(e,e+t)),l=new TextDecoder("utf-8").decode(a.slice(n,n+i));return s.fds[r].path_symlink(o,l)}return 8},path_unlink_file(e,t,r){const n=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const i=new TextDecoder("utf-8").decode(n.slice(t,t+r));return s.fds[e].path_unlink_file(i)}return 8},poll_oneoff(e,t,r){throw"async io not supported"},proc_exit(e){throw"exit with exit code "+e},proc_raise(e){throw"raised signal "+e},sched_yield(){},random_get(e,t){const r=new Uint8Array(s.inst.exports.memory.buffer);for(let n=0;n<t;n++)r[e+n]=256*Math.random()|0},sock_recv(e,t,r){throw"sockets not supported"},sock_send(e,t,r){throw"sockets not supported"},sock_shutdown(e,t){throw"sockets not supported"},sock_accept(e,t){throw"sockets not supported"}}}}(["ruby.wasm","-e_=0"],[],[new R(new B([])),new R(new B([])),new R(new B([])),new P("/",e)],{debug:!1}),this.keyEventConsumer=new ae([])}computeOptions(e){const t=[],r={"Lan_Master.nes":"/optcarrot/examples/Lan_Master.nes"};if(e.opt&&t.push("--opt"),!r[e.rom])throw new Error(`Unknown ROM: ${e.rom}`);return t.push(r[e.rom]),t}async init(e,t,r,n){this.remoteRender=t,this.remotePlayAudio=r,n({kind:"message",value:"Downloading..."}),n({kind:"progress",value:0});const s=await fetch("./optcarrot.wasm"),i=await s.arrayBuffer();n({kind:"progress",value:.2}),n({kind:"message",value:"Instantiating Optcarrot..."});const a={wasi_snapshot_preview1:this.wasi.wasiImport},o=new H;o.addToImports(a);const{instance:l}=await WebAssembly.instantiate(i,a);await o.setInstance(l),n({kind:"progress",value:.3}),this.wasi.initialize(l),o.initialize(),n({kind:"progress",value:.6}),console.time("init-optcarrot"),console.log("Options:",e),o.eval('\n      require "js"\n      JS::eval("console.time(\'require-optcarrot\')")\n      require_relative "/optcarrot/lib/optcarrot.rb"\n      JS::eval("console.timeEnd(\'require-optcarrot\')")\n    '),n({kind:"progress",value:.8}),this.tickVideo=e.headless?()=>{this.remoteRender(new Uint8Array)}:()=>{const e=this.videoBytes();this.remoteRender(m(e,[e.buffer]))},this.tickAudio=e.headless?()=>{this.remotePlayAudio(new Int16Array)}:()=>{const e=this.audioBytes();this.remotePlayAudio(m(e,[e.buffer]))},o.eval(`\n      ${e.headless?'\nmodule Optcarrot\n  # Audio output driver for Web Audio API\n  class WebAudioAudio < Audio\n    def tick(output)\n      JS::eval("globalThis.Optcarrot.tickAudio()")\n    end\n  end\n  # Video output driver for Web Canvas\n  class CanvasVideo < Video\n    def tick(screen)\n      JS::eval("globalThis.Optcarrot.tickVideo()")\n    end\n  end\n  BrowserInput = Input\nend\n':'\nmodule Optcarrot\n  # Audio output driver for Web Audio API\n  class WebAudioAudio < Audio\n    def tick(output)\n      bin = output.pack(@pack_format)\n      File.binwrite(File.join("/OPTCARROT_TMP/audio.data"), bin)\n      JS::eval("globalThis.Optcarrot.tickAudio()")\n    rescue => e\n      JS.global[:console].warn(e.inspect)\n    end\n  end\n  # Video output driver for Web Canvas\n  class CanvasVideo < Video\n    def init\n      super\n      @palette = @palette_rgb.map do |r, g, b|\n        0xff000000 | (b << 16) | (g << 8) | r\n      end\n    end\n\n    def dispose\n    end\n\n    def tick(screen)\n      bin = screen.pack("L*")\n      File.binwrite(File.join("/OPTCARROT_TMP", File.basename(@conf.video_output, ".EXT") + ".data"), bin)\n      JS::eval("globalThis.Optcarrot.tickVideo()")\n      super\n    rescue => e\n      JS.global[:console].warn(e.inspect)\n    end\n  end\n  # Input driver for browser input\n  class BrowserInput < Input\n    def init\n    end\n\n    def dispose\n    end\n\n    def tick(frame, pads)\n      event = JS::eval("return globalThis.Optcarrot.fetchKeyEvent()").inspect\n      return if event == ""\n      code, pressed = event.split(",")\n      code = code.to_i\n      if pressed == "true"\n        pads.keydown(0, code)\n      else\n        pads.keyup(0, code)\n      end\n    end\n  end\nend\n'}\n\n      # Monkey patch the Optcarrot to use web drivers\n      Optcarrot::Driver.define_singleton_method(:load) do |conf|\n        video = Optcarrot::CanvasVideo.new(conf)\n        audio = Optcarrot::WebAudioAudio.new(conf)\n        input = Optcarrot::BrowserInput.new(conf, video)\n        [video, audio, input]\n      end\n\n      args = [\n          ${this.computeOptions(e).map((e=>`"${e}"`)).join(", ")},\n          "--audio-sample-rate=11050",\n      ]\n      JS::eval("console.time('Optcarrot::NES.new')")\n      $nes = Optcarrot::NES.new(args)\n      JS::eval("console.timeEnd('Optcarrot::NES.new')")\n    `),n({kind:"progress",value:1}),n({kind:"done"}),o.eval("$nes.reset"),this.vm=o,this.run()}run(){setTimeout(this.run.bind(this),0),this.vm.eval("$nes.step")}videoBytes(){return this.rootFs.OPTCARROT_TMP.get_entry_for_path("video.data").data}audioBytes(){const e=this.rootFs.OPTCARROT_TMP.get_entry_for_path("audio.data");return new Int16Array(e.data.buffer)}pushKeyEvent(e,t){this.keyEventConsumer.push(e,t)}fetchKeyEvent(){const e=this.keyEventConsumer.consume();return e?e.join(","):""}}"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&(()=>{const e=new oe;globalThis.Optcarrot=e,d({init(t,r,n,s){try{e.init(t,r,n,s).catch((e=>{s({kind:"error",message:"Failed to initialize Optcarrot: "+e.message})}))}catch(e){s({kind:"error",message:"Failed to initialize Optcarrot: "+e.message})}},pushKeyEvent(t,r){e.pushKeyEvent(t,r)}})})();var le=s("86Wyx");class ce{constructor(e){this.canvasContext=e.getContext("2d"),this.scalingCanvas=document.createElement("canvas"),this.scalingCanvas.width=e.width,this.scalingCanvas.height=e.height,this.scalingContext=this.scalingCanvas.getContext("2d"),this.canvasContext.scale(2,2)}draw(e){const t=new Uint8ClampedArray(e.buffer),r=new ImageData(t,256,240);this.scalingContext.putImageData(r,0,0),this.canvasContext.drawImage(this.scalingCanvas,0,0)}}class ue{constructor(){this.context=new AudioContext({sampleRate:11050}),this.scheduledTime=0}push(e){const t=this.context.createBuffer(1,e.length,this.context.sampleRate),r=this.context.createBufferSource(),n=t.getChannelData(0),s=this.context.currentTime;for(let t=0;t<e.length;t++)n[t]=e[t]/65536;r.buffer=t,r.connect(this.context.destination),s<this.scheduledTime?(r.start(this.scheduledTime),this.scheduledTime+=t.duration):(console.warn("Audio buffer underrun :(",this.scheduledTime-s),r.start(s),this.scheduledTime=s+t.duration)}}class de{constructor(){this.times=[]}tick(){const e=performance.now();for(;this.times.length>0&&this.times[0]<=e-1e3;)this.times.shift();return this.times.push(e),this.times.length}}const fe=e=>{switch(e){case"KeyZ":return 0;case"KeyX":return 1;case"Enter":return 2;case"Space":return 3;case"ArrowUp":return 4;case"ArrowDown":return 5;case"ArrowLeft":return 6;case"ArrowRight":return 7;default:return null}},he=new class{constructor(e,t){this.progress=e,this.progress.max=1,this.message=t}log(e){this.message.innerText=e}error(e){this.message.innerText=e,this.progress.hidden=!0}setProgress(e){this.progress.value=e}hide(){this.progress.hidden=!0,this.message.hidden=!0}}(document.getElementById("loading-progress"),document.getElementById("loading-message"));var be,pe;pe=function(e,t,r){if(t===self.location.origin)return e;var n=r?"import "+JSON.stringify(e)+";":"importScripts("+JSON.stringify(e)+");";return URL.createObjectURL(new Blob([n],{type:"application/javascript"}))};let we=new URL(s("27Lyk").resolve("3YKzz"),import.meta.url);be=pe(we.toString(),we.origin,!0);const ge=(()=>{const e=le.UAParser(navigator.userAgent);if("iOS"!==e.os.name){if("Safari"===e.browser.name){return new oe}return h(new Worker(be))}he.error("Optcarrot is not supported on iOS due to WebKit stack size limitation.")})();globalThis.Optcarrot=ge,(async(e,t,r)=>{const n=new ce(document.getElementById("nes-video"));let s=null;r.log("Initializing Optcarrot...");const i=new de,a=document.getElementById("fps-indicator"),o=document.getElementById("audio-enabled");let l=o.checked;o.onclick=()=>{l=o.checked},document.addEventListener("keydown",(t=>{const r=fe(t.code);null!==r&&(t.preventDefault(),e.pushKeyEvent(r,!0))})),document.addEventListener("keyup",(t=>{const r=fe(t.code);null!==r&&e.pushKeyEvent(r,!1)}));const c=(e=>{const t=e.searchParams.get("opt"),r=e.searchParams.get("headless"),n=e.searchParams.get("rom");return{opt:null===t||"true"===t,headless:null!==r&&"true"===r,rom:null===n?"Lan_Master.nes":n}})(t),u=c.headless?e=>{a.innerText=i.tick().toString()}:e=>{n.draw(e),a.innerText=i.tick().toString()};e.init(c,_(u),_((e=>{l&&(null===s&&(s=new ue),s.push(e))})),_((e=>{switch(e.kind){case"error":r.error(e.message);break;case"message":r.log(e.value);break;case"done":r.hide();break;case"progress":r.setProgress(e.value)}})))})(ge,new URL(window.location.href),he);
//# sourceMappingURL=index.b971d4f8.js.map
